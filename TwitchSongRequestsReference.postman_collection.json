{
	"info": {
		"_postman_id": "18ae127b-8e3e-4a46-9207-c437b5b9aea1",
		"name": "TwitchSongRequestsReference",
		"description": "Collection of API calls to help document the authorization flow for Twitch/Spotify user authorization grants",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "TWITCH Get OAuth token from authorization code",
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "https://id.twitch.tv/oauth2/token?client_id={{twitch_client_id}}&client_secret={{twitch_client_secret}}&grant_type=authorization_code&code={{twitch_auth_code}}&redirect_uri=https://github.com/SaxyPandaBear/TwitchSongRequests",
					"protocol": "https",
					"host": [
						"id",
						"twitch",
						"tv"
					],
					"path": [
						"oauth2",
						"token"
					],
					"query": [
						{
							"key": "client_id",
							"value": "{{twitch_client_id}}"
						},
						{
							"key": "client_secret",
							"value": "{{twitch_client_secret}}"
						},
						{
							"key": "grant_type",
							"value": "authorization_code"
						},
						{
							"key": "code",
							"value": "{{twitch_auth_code}}"
						},
						{
							"key": "redirect_uri",
							"value": "https://github.com/SaxyPandaBear/TwitchSongRequests"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "TWITCH Get user authorization code with required scopes",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "https://id.twitch.tv/oauth2/authorize?client_id={{twitch_client_id}}&redirect_uri=https://github.com/SaxyPandaBear/TwitchSongRequests&response_type=code&scope=channel_read+channel:read:redemptions",
					"protocol": "https",
					"host": [
						"id",
						"twitch",
						"tv"
					],
					"path": [
						"oauth2",
						"authorize"
					],
					"query": [
						{
							"key": "client_id",
							"value": "{{twitch_client_id}}"
						},
						{
							"key": "redirect_uri",
							"value": "https://github.com/SaxyPandaBear/TwitchSongRequests"
						},
						{
							"key": "response_type",
							"value": "code"
						},
						{
							"key": "scope",
							"value": "channel_read+channel:read:redemptions"
						}
					]
				},
				"description": "IMPORTANT NOTE: This does not work in Postman. The URL needs to be resolved with the required variables and then copy pasted into the browser for the user to login and authorize the access request made by this client ID.\r\nThis is so that I can fetch the OAuth code, with required scopes, in order to get an OAuth bearer token to authenticate against the Twitch API to GET the channel details for the given user who authorized the request, as well as to subscribe to that same user's channel point redemption topic."
			},
			"response": []
		},
		{
			"name": "TWITCH Get user channel object",
			"request": {
				"auth": {
					"type": "oauth2",
					"oauth2": [
						{
							"key": "accessToken",
							"value": "{{twitch_access_token}}",
							"type": "string"
						},
						{
							"key": "headerPrefix",
							"value": "OAuth ",
							"type": "string"
						},
						{
							"key": "addTokenTo",
							"value": "header",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [
					{
						"key": "Client-ID",
						"value": "{{twitch_client_id}}",
						"type": "text"
					},
					{
						"key": "Accept",
						"value": "application/vnd.twitchtv.v5+json",
						"type": "text"
					}
				],
				"url": {
					"raw": "https://api.twitch.tv/kraken/channel",
					"protocol": "https",
					"host": [
						"api",
						"twitch",
						"tv"
					],
					"path": [
						"kraken",
						"channel"
					]
				}
			},
			"response": []
		},
		{
			"name": "SPOTIFY Get user authorization code with scopes",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "https://accounts.spotify.com/authorize?client_id={{spotify_client_id}}&response_type=code&scope=user-modify-playback-state+user-read-playback-state&redirect_uri=https://github.com/SaxyPandaBear/TwitchSongRequests",
					"protocol": "https",
					"host": [
						"accounts",
						"spotify",
						"com"
					],
					"path": [
						"authorize"
					],
					"query": [
						{
							"key": "client_id",
							"value": "{{spotify_client_id}}"
						},
						{
							"key": "response_type",
							"value": "code"
						},
						{
							"key": "scope",
							"value": "user-modify-playback-state+user-read-playback-state"
						},
						{
							"key": "redirect_uri",
							"value": "https://github.com/SaxyPandaBear/TwitchSongRequests"
						}
					]
				},
				"description": "IMPORTANT NOTE: This does not work in Postman. The URL needs to be resolved with the required variables and then copy pasted into the browser for the user to login and authorize the access request made by this client ID. This is so that I can fetch the OAuth code, with required scopes, in order to get an OAuth bearer token to authenticate against the Spotify API."
			},
			"response": []
		},
		{
			"name": "SPOTIFY Get OAuth token from authorization code",
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "authorization_code",
							"type": "text"
						},
						{
							"key": "code",
							"value": "{{spotify_auth_code}}",
							"type": "text"
						},
						{
							"key": "redirect_uri",
							"value": "https://github.com/SaxyPandaBear/TwitchSongRequests",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "{{spotify_client_id}}",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "{{spotify_client_secret}}",
							"type": "text"
						}
					],
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://accounts.spotify.com/api/token",
					"protocol": "https",
					"host": [
						"accounts",
						"spotify",
						"com"
					],
					"path": [
						"api",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "SPOTIFY Get Refresh Token",
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "refresh_token",
							"value": "AQCaaFEeaH_F-ql944G97_3NnUu16XHYU5kSZn7fY8z9-3z38s9SH2o3SweaHy8b0CRWj-_nAkLDEA9SI4tG3HctHB15LyXObXI1mPolo2jwl9qwKLsbWqbdJDBXdP2bmJ8",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "refresh_token",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "{{spotify_client_id}}",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "{{spotify_client_secret}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "https://accounts.spotify.com/api/token",
					"protocol": "https",
					"host": [
						"accounts",
						"spotify",
						"com"
					],
					"path": [
						"api",
						"token"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "1e86a1d4-ac4c-4def-92e6-c388479297e2",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "6702d9a5-04b8-4422-b2b7-88f438113b08",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "85b64793-8185-4438-8dd6-c355dbf8e7ab",
			"key": "twitch_client_id",
			"value": ""
		},
		{
			"id": "58711b42-441e-4eb0-917b-c099a9ddac88",
			"key": "twitch_client_secret",
			"value": null
		},
		{
			"id": "bcbe8760-82a6-4ba8-aab7-48a3ed5cd737",
			"key": "spotify_client_id",
			"value": null
		},
		{
			"id": "f90b36b9-0e6a-4f34-96e9-2f8329aea159",
			"key": "spotify_client_secret",
			"value": null
		},
		{
			"id": "b8c7e021-e88e-4f57-871c-6184c4250efe",
			"key": "twitch_auth_code",
			"value": null
		},
		{
			"id": "224b010f-58fa-4714-ae56-34e5b7e01a57",
			"key": "spotify_auth_code",
			"value": null
		},
		{
			"id": "6e2fa992-07a6-46c1-99c9-f6d211e09201",
			"key": "twitch_access_token",
			"value": ""
		},
		{
			"id": "3d564bb2-9690-4dca-ba88-7b8f3e8d06bb",
			"key": "spotify_access_token",
			"value": ""
		}
	],
	"protocolProfileBehavior": {}
}